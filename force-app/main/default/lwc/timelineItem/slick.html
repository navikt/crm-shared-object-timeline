<template>
    <div lwc:if={showRow}>
        <li class="row">
            <span class="slds-assistive-text">{row.record.sObjectLabel}</span>
            <div class="slds-media">
                <div class="table">
                    <div class="cell cell-left">
                        <div class="container">
                            <lightning-icon class="cell-icon" size="medium" icon-name={row.theme.icon}>
                            </lightning-icon>
                            <div class="stripe" is-last={isLast} style={timelineColor}></div>
                        </div>
                    </div>
                    <div class="cell cell-right">
                        <div class="slds-media__body">
                            <c-nks-expandable-panel is-expandable={isExpandable}>
                                <div slot="title">
                                    <h3 style="display: contents" class="slds-truncate" title={row.record.title}>
                                        <strong>
                                            <lightning-formatted-rich-text class="img-reset" value={row.record.title}>
                                            </lightning-formatted-rich-text>
                                        </strong>
                                    </h3>
                                    <div aria-hidden="true" class="text-divider"></div>
                                    <template lwc:if={row.record.overdue}>
                                        <p class="slds-timeline__date slds-text-color_error">
                                            {dateFormat}
                                        </p>
                                    </template>
                                    <template lwc:else >
                                        <p class="slds-timeline__date" style="display: contents">
                                            {dateFormat}
                                        </p>
                                    </template>
                                </div>
                                <template lwc:if={showSubtitle}>
                                    <p slot="subtitle">
                                        <template lwc:if={isAssigneeAUser}>
                                            <a data-id={row.record.assigneeId} onclick={openUser}>
                                                {row.record.assignee}
                                            </a>
                                        </template>
                                        <template lwc:else>
                                            <span>{row.record.assignee}</span>
                                        </template>
                                        <template lwc:if={isRelatedUserAUser}>
                                            <a data-id={row.record.relatedUserId} onclick={openUser}>
                                                {row.record.relatedUser}
                                            </a>
                                        </template>
                                        <template lwc:else>
                                            <span>{row.record.relatedUser}</span>
                                        </template>
                                        <template lwc:if={isOverride}>
                                            <span class="slds-assistive-text">{assistiveSubtitle}</span>
                                            <lightning-formatted-rich-text
                                                aria-hidden="true"
                                                class="slds-line-clamp_small"
                                                value={row.record.subtitleOverride}
                                            ></lightning-formatted-rich-text>
                                        </template>
                                        <template lwc:else>
                                            <span>{row.record.subtitle}</span> 
                                        </template>
                                    </p>
                                </template>
                                <template lwc:if={isCustom}>
                                    <c-timeline-custom-view
                                        record-id={row.record.recordId}
                                        custom-component-name={row.record.customComponent}
                                    ></c-timeline-custom-view>
                                </template>
                            </c-nks-expandable-panel>
                        </div>
                    </div>
                </div>
            </div>
        </li>
    </div>
</template>
